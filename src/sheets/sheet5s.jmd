**Numerical Analysis MATH50003 (2023â€“24) Problem Sheet 5**



**Problem 1(a)**  Suppose $|Ïµ_k| â‰¤ Ïµ$ and $n Ïµ < 1$. Use induction to show that
$$
âˆ_{k=1}^n (1+Ïµ_k) = 1+Î¸_n
$$
for some constant $Î¸_n$ satisfying
$$
|Î¸_n| â‰¤ \underbrace{n Ïµ \over 1-nÏµ}_{E_{n,Ïµ}}
$$

**SOLUTION**

$$
âˆ_{k=1}^{n+1} (1+Ïµ_k) = âˆ_{k=1}^n (1+Ïµ_k) (1+Ïµ_{n+1}) = (1+Î¸_n)(1+Ïµ_{n+1}) = 1 + \underbrace{Î¸_n + Ïµ_{n+1} + Î¸_nÏµ_{n+1}}_{Î¸_{n+1}}
$$
where
$$
\begin{align*}
|Î¸_{n+1}| &â‰¤ {n Ïµ \over 1-nÏµ}(1+Ïµ) + Ïµ \\
&={n Ïµ + n Ïµ^2 \over 1-(n+1)Ïµ} \underbrace{{1-(n+1)Ïµ \over 1-nÏµ}}_{â‰¤ 1}  + {Ïµ-(n+1)Ïµ^2 \over 1-(n+1)Ïµ} \\
&â‰¤ {(n+1)  -  Ïµ \over 1-(n+1)Ïµ} Ïµ â‰¤ {(n+1) Ïµ \over 1-(n+1)Ïµ} = E_{n+1,Ïµ}.
\end{align*}
$$

**END**


**Problem 1(b)** Show for an idealised floating point vector $ð± âˆˆ F_{âˆž,S}^n$ 
that
$$
x_1 âŠ• â‹¯ âŠ• x_n = x_1 +  â‹¯ + x_n + Ïƒ_n
$$
where
$$
|Ïƒ_n| â‰¤ \| ð± \|_1 E_{n-1,Ïµ_{\rm m}/2},
$$
assuming $n Ïµ_{\rm m} < 2$ and where
$$
\|ð±\|_1 := âˆ‘_{k=1}^n |x_k|.
$$
Hint: use the previous part to first write
$$
x_1 âŠ• â‹¯ âŠ• x_n = x_1(1+Î¸_{n-1}) + âˆ‘_{j=2}^n x_j (1 + Î¸_{n-j+1}).
$$


**SOLUTION**

Using Problem 2.1 we write:
$$
\meeq{
(â‹¯((x_1 + x_2)(1+Î´_1) + x_3)(1+Î´_2)â‹¯+x_n)(1+Î´_{n-1})
= x_1 âˆ_{k=1}^{n-1} (1+Î´_k) +  âˆ‘_{j=2}^n x_j âˆ_{k=j-1}^{n-1} (1+Î´_j) \ccr
= x_1(1+Î¸_{n-1}) + âˆ‘_{j=2}^n x_j (1 + Î¸_{n-j+1})
}
$$
where we have for $j = 2,â€¦,n$
$$
|Î¸_{n-j+1}| â‰¤ E_{n-j+1,Ïµ_{\rm m}/2} â‰¤ E_{n-1,Ïµ_{\rm m}/2}.
$$
Thus we have 
$$
âˆ‘_{j=1}^n x_j (1 + Î¸_{n-j+1})= âˆ‘_{j=1}^n x_j + \underbrace{âˆ‘_{j=1}^n x_j Î¸_{n-j+1}}_{Ïƒ_n}
$$
where
$$
|Ïƒ_n| â‰¤  âˆ‘_{j=1}^n |x_j Î¸_{n-j+1}| â‰¤ \sup_j |Î¸_{n-j+1}| âˆ‘_{j=1}^n |x_j|  â‰¤ \| ð±\|_1 E_{n-1,Ïµ_{\rm m}/2}.
$$


**END**

**Problem 1(c)** For $A âˆˆ F_{âˆž,S}^{n Ã— n}$ and $ð± âˆˆ F_{âˆž,S}^n$ consider the error
in approximating matrix multiplication with idealised floating point: for
$$
A ð± =  \begin{pmatrix}
â¨_{j=1}^n A_{1,j} âŠ— x_j\\
â‹® \\
â¨_{j=1}^n A_{1,j} âŠ— x_j
\end{pmatrix} + Î´
$$
show that
$$
\| Î´ \|_âˆž â‰¤ 2 \|A\|_âˆž \| ð± \|_âˆž E_{n,Ïµ_{\rm m}/2}
$$
where  $n Ïµ_{\rm m} < 2$ and the matrix norm is $\|A \|_âˆž := \max_k âˆ‘_{j=1}^n |a_{kj}|$.

**SOLUTION**
We have for the $k$=th row
$$
â¨_{j=1}^n A_{k,j} âŠ— x_j =  â¨_{j=1}^n A_{k,j} x_j (1+Î´_j) = 
âˆ‘_{j=1}^n A_{k,j} x_j (1+Î´_j) + Ïƒ_{k,n}
$$
where we know $|Ïƒ_n| â‰¤ M_k E_{n-1,Ïµ_{\rm m}/2}$, where from 1(b) we have
$$
M_k = Î£_{j=1}^n |A_{k,j}x_j (1+Î´_j)| = Î£_{j=1}^n |A_{k,j}| |x_j| (1+|Î´_j|)  â‰¤ 2 \max |x_j| Î£_{j=1}^n |A_{k,j}|
â‰¤ 2 \|ð±\|_âˆž \|A \|_âˆž
$$
Similarly, we also have 
$$
|âˆ‘_{j=1}^n A_{k,j} x_j Î´_j| â‰¤ \|ð±\|_âˆž \|A \|_âˆž Ïµ_{\rm m}/2
$$
and so the result follows from
$$
Ïµ_{\rm m}/2 + 2E_{n-1,Ïµ_{\rm m}/2} â‰¤ {Ïµ_{\rm m}/2 + Ïµ_{\rm m} (n-1) \over 1-(n-1)Ïµ_{\rm m}/2} â‰¤ {Ïµ_{\rm m} n \over 1-nÏµ_{\rm m}/2} = 2E_{n,Ïµ_{\rm m}/2}.
$$
**END**



---------


**Problem 2** Derive  Backward Euler: use the left-sided divided difference approximation
$$
u'(x) â‰ˆ {u(x) - u(x-h)  \over h}
$$
to reduce the first order ODE
$$
\meeq{
u(a) =  c, \qquad u'(x) + Ï‰(x) u(x) = f(x)
}
$$
to a lower triangular system by discretising on the grid $x_j = a + j h$ for $h = (b-a)/n$. Hint: only impose the ODE on the
gridpoints $x_1,â€¦,x_n$ so that the divided difference does not depend on behaviour at $x_{-1}$.


**SOLUTION**

We go through all 4 steps (this is to help you understand what to do. In an exam I will still give full credit if you get the right result,
even if you don't write down all 4 steps):

(Step 1) Since we need to avoid going off the left in step 2 we start the ODE discretisation at $x_1$:
$$
\Vectt[u(x_0), u'(x_1) +  Ï‰(x_1)u(x_1), â‹®, u'(x_n) +  Ï‰(x_n)u(x_n)] = \underbrace{\Vectt[c, f(x_1),â‹®,f(x_n)]}_{ð›}
$$

(Step 2) Replace with divided differences:
$$
\Vectt[u(x_0), (u(x_1)-u(x_0))/h +  Ï‰(x_1)u(x_1), â‹®, (u(x_n)-u(x_{n-1}))/h +  Ï‰(x_n)u(x_n)] â‰ˆ ð›
$$

(Step 3) Replace with discrete system with equality:
$$
\Vectt[u_0, (u_1-u_0)/h +  Ï‰(x_1)u_1, â‹®, (u_n-u_{n-1}))/h +  Ï‰(x_n)u_n] = ð›
$$

(Step 4) Write as linear system:
$$
\begin{bmatrix}
1 \\
-1/h & 1/h + Ï‰(x_1) \\
& â‹± & â‹± \\
&& -1/h & 1/h + Ï‰(x_n)
\end{bmatrix} \Vectt[u_0,â‹®,u_n] = ð›
$$


**END**


**Problem 3** Reduce a SchrÃ¶dinger equation to a tridiagonal linear system by discretising on the grid $x_j = a + j h$ for $h = (b-a)/n$:
$$
\meeq{
u(a) =  c,\qquad u''(x) + V(x) u(x) = f(x), \qquad u(b) = d.
}
$$

**SOLUTION**

(Step 1) 
$$
\Vectt[u(x_0), u''(x_1) + V(x_1) u(x_1), â‹®, u'(x_{n-1}) + V(x_{n-1}) u(x_{n-1}), u(x_n)] = \underbrace{\Vectt[c, f(x_1),â‹®,f(x_{n-1}), d]}_{ð›}
$$

(Step 2) Replace with divided differences:
$$
\Vectt[u(x_0), (u(x_0)-2u(x_1)+u(x_2))/h^2 + V(x_1)u(x_1), â‹®, (u(x_{n-2} - 2u(x_{n-1})+u(x_n))/h^2 + V(x_{n-1})u(x_{n-1}), u(x_n)] â‰ˆ ð›
$$

(Step 3) Replace with discrete system with equality:
$$
\Vectt[u_0, (u_0-2u_1+u_2)/h^2 + V(x_1)u_1, â‹®, (u_{n-2}-2u_{n-1}+u_n))/h^2+ V(x_{n-1})u_{n-1},u_n] = ð›
$$

(Step 4) Write as a tridiagonal linear system:
$$
\begin{bmatrix}
1 \\
1/h^2 & V(x_1)-2/h^2 & 1/h^2 \\
& â‹± & â‹± & â‹± \\
&&1/h^2 & V(x_{n-1})-2/h^2 & 1/h^2 \\
&& &&1
\end{bmatrix} \Vectt[u_0,â‹®,u_n] = ð›
$$


**END**